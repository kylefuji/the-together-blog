<!doctype html>
<html lang="en">
    {% load static %}
    {% get_static_prefix as STATIC_URL %}
    <head>
        <!-- Required meta tags -->
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

        <!-- Bootstrap CSS -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
        <link rel="shortcut icon" type="image/x-icon" href="{% static 'images/heart.svg' %}" />
        <title>The Together Blog</title>
    </head>
    <body>
        {% if staff %}
            {% include "navbarstaff.html" %}
        {% elif login %}
            {% include "navbarloggedin.html" %}
        {% else %}
            {% include "navbar.html" %}
        {% endif %}
        <!-- <div class="container" style="max-width: 80% !important;"> -->
            <div class="container">
            <div class="row no-gutters" style="margin-top: 5em;">
                <div class="col-lg-8">
                    <div id="carouselIndicators" class="carousel slide" data-ride="carousel">
                        <ol class="carousel-indicators">
                            {% for i in sliderRange %}
                            {% if i == 0 %}
                            <li data-target="#carouselIndicators" data-slide-to="{{i}}" class="bg-secondary active"></li>
                            {% else %}
                            <li data-target="#carouselIndicators" class="bg-secondary" data-slide-to="{{i}}"></li>
                            {% endif %}
                            {% endfor %}
                        </ol>
                        <div class="carousel-inner" >
                            {% for i in sliderRange %}
                            {% if i == 0 %}
                            <div class="carousel-item active">
                                <div class="shadow">
                                    <img class="d-block w-100"  src="{{ STATIC_URL }}images/{{ i }}.jpg" alt="">
                                </div>
                            </div>
                            {% else %}
                            <div class="carousel-item">
                                <div class="shadow">
                                    <img class="d-block w-100"  src="{{ STATIC_URL }}images/{{ i }}.jpg" alt="">
                                </div>
                            </div>
                            {% endif %}
                            {% endfor %}
                        </div>
                        <a class="carousel-control-prev" href="#carouselIndicators" role="button" data-slide="prev">
                            <span class="carousel-control-prev-icon bg-secondary" aria-hidden="true"></span>
                            <span class="sr-only">Previous</span>
                        </a>
                        <a class="carousel-control-next" href="#carouselIndicators" role="button" data-slide="next">
                            <span class="carousel-control-next-icon bg-secondary" aria-hidden="true"></span>
                            <span class="sr-only">Next</span>
                        </a>
                    </div>
                </div>
                <div class="col-lg-4">
                    <div class="card d-block w-100 h-100">
                        <div class="card-header">
                            <h5 class="card-title">Kyle and Marlianne's Blog</h5>
                        </div>
                        <div class="card-body">
                            <p class="card-text">Welcome to our blog. This is a place where Kyle and Marlianne store their cherished memories.</p>
                            <p class="card-text">We're glad you're here!</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="post-stream">
            </div>
            <!-- {% for i in sliderRange %}
            <div class="row mt-5 mb-5 justify-content-center">
                <div class="col-lg-8">
                    <div class="card">
                        <div class="shadow">
                            <img class="card-img-top" src="{{ STATIC_URL }}images/{{ i }}.jpg" alt="">
                        </div>
                        <div class="card-img-overlay">
                            <div class="card-body">
                                <h5 class="card-title" style="overflow: hidden; white-space: nowrap;">Blog Post Title</h5>
                            </div>
                        </div>
                        <div class="card-body">
                            <p class="card-text" style="overflow: hidden; white-space: nowrap;">Blog Post Content explaining this particular blog post. Let's make this ridiculously long by typing utter nonesense. wefewargaergeragaergaergepijgejgojerogijeoagkeapgkopkrgpaejgoneag w ek gpekspg keroig jeor jegoj ojgoe jeoj geosjb oj</p>
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %} -->
        </div>
    </body>
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>

    <script>
        function fetchJSON(url, data={}) {
            return fetch(url, data).then((response) => {
                return response.json();
            });
        }
        function getPosts() {
            url = "{% url 'api_post' %}";
            fetchJSON(url).then((response) => {
                for(var post of response.posts) {
                    var newElement = document.createElement('div');
                    var classAttr = document.createAttribute("class");
                    classAttr.value = "row mt-5 mb-5 justify-content-center";
                    newElement.setAttributeNode(classAttr);
                    var postHtml = '<div class="col-lg-8"><div class="card"><div class="shadow">' +
                        '<img class="card-img-top" src="';
                    try {
                        var imageURLs = JSON.parse(post.imageURLs);
                        console.log(imageURLs);
                        if (imageURLs[0]) {
                            postHtml += imageURLs[0] + '" alt="">';
                        } else {
                            postHtml += '{{ STATIC_URL }}images/default.png" alt="">';
                        }
                    } catch(err) {
                        postHtml += '{{ STATIC_URL }}images/default.png" alt="">';
                    }
                    postHtml +='</div><div class="card-img-overlay"><div class="card-body"><h5 class="card-title" style="overflow: ' + 
                        'hidden; white-space: nowrap;">' + post.title + '</h5></div></div><div class="card-body">' + 
                        '<p class="card-text" style="overflow: hidden; white-space: nowrap;">' + post.content + '</p></div>' + 
                        '</div></div>';
                    
                    newElement.innerHTML = postHtml;

                    document.querySelector(".post-stream").appendChild(newElement);
                }
            }).catch((error) => {
                console.error('Error:', error);
            });
        }
        window.onload = function() {
            getPosts();
        }
    </script>



    <style>
        body {
            background-image: linear-gradient(to left, rgb(200, 200, 200),white);
        }
        .shadow
        {
            display:block;
            position:relative;
        }

        .shadow:before
        {
            display:block;
            content:'';
            position:absolute;
            width:100%;
            height:100%;
            -moz-box-shadow:inset 0px 0px 50px 50px rgba(255,255,255,1);
            -webkit-box-shadow:inset 0px 0px 50px 50px rgba(255,255,255,1);
            box-shadow:inset 0px 0px 50px 50px rgba(255,255,255,1);
        }

        .active
        {
            background-color: rgb(50, 50, 50) !important;
        }

    </style>

</html>